var gv_OriginalTextCache=new Object();var gv_OriginalImgSrc=new Object();var gv_vAlignTable=new Object();var windowEvent;var bIE=false;if((index=navigator.userAgent.indexOf("MSIE"))>=0){bIE=true}var Forms=document.getElementsByTagName("FORM");for(var i=0;i<Forms.length;i++){var Form=Forms(i);Form.onclick=SuppressBubble}function SuppressBubble(a){if(bIE){window.event.cancelBubble=true;window.event.returnValue=false}else{if(a){a.stopPropagation()}}}function InsertAfterBegin(d,b){if(!bIE){var c;var a=d.ownerDocument.createRange();a.selectNodeContents(d);a.collapse(true);c=a.createContextualFragment(b);d.insertBefore(c,d.firstChild)}else{d.insertAdjacentHTML("afterBegin",b)}}function InsertBeforeEnd(d,b){if(!bIE){var c;var a=d.ownerDocument.createRange();a.selectNodeContents(d);a.collapse(d);c=a.createContextualFragment(b);d.appendChild(c)}else{d.insertAdjacentHTML("beforeEnd",b)}}var MaxZIndex=1000;var MinZIndex=-1000;function Workflow(a){return a+"WF"}function BringToFront(b){var a=document.getElementById(b);if(a==null){return}MaxZIndex=MaxZIndex+1;a.style.zIndex=MaxZIndex}function SendToBack(b){var a=document.getElementById(b);if(a==null){return}MinZIndex=MinZIndex-1;a.style.zIndex=MinZIndex}function HideElement(b){var a=document.getElementById(b);a.style.visibility="hidden";RefreshScreen()}function RefreshScreen(){var b=document.body.style.backgroundColor;var a=(b=="rgb(0,0,0)")?"#FFFFFF":"#000000";document.body.style.backgroundColor=a;document.body.style.backgroundColor=b}function getAbsoluteLeft(b){var a=b;var c=0;while(a.tagName!="BODY"){c+=a.offsetLeft;a=a.offsetParent}return c}function getAbsoluteTop(b){var a=b;var c=0;while(a.tagName!="BODY"){c+=a.offsetTop;a=a.offsetParent}return c}function GetAnnotationHtml(a){var c="";for(var b in a){if(b!="label"){c+="<div class='annotationName'>"+b+"</div>";c+="<div class='annotation'>"+a[b]+"</div>"}}return c}var dialogs=new Object();function ToggleWorkflow(p,l,m,j,f){if(dialogs[l]){var s=dialogs[l];dialogs[l]=undefined;if(s.dialog("isOpen")){s.dialog("close");return}}var c=$(window);var n=c.scrollTop();var o=c.scrollLeft();var t=document.getElementById(Workflow(l));var r=10;var g=10;var d=false;var k=false;var a=p.pageY-document.body.scrollTop;var e=p.pageX-document.body.scrollLeft;if(e>m+r+document.body.scrollLeft){d=true}if(a>j+g+document.body.scrollTop){k=true}var h=0;var b=0;if(k){h=a-j-20}else{h=a+10}if(d){b=e-m-4}else{b=e-6}if(bIE){j+=50}var q=window[l+"Ann"];var s=$("<div></div>").appendTo("body").html(GetAnnotationHtml(q)).dialog({title:q.label,width:m,height:j,minHeight:150,position:[b,h],dialogClass:"dialogFix"});dialogs[l]=s;window.scrollTo(o,n)}function ToggleLinks(c,b){var a=document.getElementById(b);if(a.style.visibility=="visible"){HideElement(b)}else{if(bIE){a.style.top=window.event.y+document.body.scrollTop;a.style.left=window.event.x+document.body.scrollLeft}else{a.style.top=c.pageY;a.style.left=c.pageX}a.style.visibility="visible";BringToFront(b)}RefreshScreen()}function IsTrueMouseOut(c,f){if(!f){var f=window.event}var d=(window.event)?f.srcElement:f.target;if(d.id!=c&&d.id!="o"+c){return false}while(d.nodeName!="HTML"){if(d.style.visibility=="hidden"){return false}d=d.parentNode}var a=(f.relatedTarget)?f.relatedTarget:f.toElement;while(a!=null&&a.nodeName!="HTML"){var g=a.id;var b=g.indexOf("Links");if(b>0){if(g.substring(0,b)==d.id){return false}}a=a.parentNode;if(a.id==c){return false}}return true}function IsTrueMouseOver(c,f){if(!f){var f=window.event}var d=(window.event)?f.srcElement:f.target;if(d.id!=c&&d.id!="o"+c){return false}var a=(f.relatedTarget)?f.relatedTarget:f.fromElement;while(a!=null&&a.nodeName!="HTML"){var g=a.id;var b=g.indexOf("Links");if(b>0){if(g.substring(0,b)==d.id){return false}}a=a.parentNode;if(a.id==c){return false}}return true}function NewTab(b,a){window.open(b,a)}function NewWindow(h,c,f,b,e,a){if(b){var d=(screen.width-e)/2;var g=(screen.height-a)/2;f=f+", left="+d+", top="+g}window.open(h,c,f)}function ParentWindowNeedsReload(b){var d=false;try{var a=top.opener.window.location.href.split("#")[0];var c=a.lastIndexOf("/");if(c>0){a=a.substring(c+1,a.length);if(a==encodeURI(b)){d=true}}}catch(f){}return d}function FrameWindowNeedsReload(d,a){var f=false;try{var c=d.contentWindow.location.href.split("#")[0];var b=c.lastIndexOf("/");if(b>0){c=c.substring(b+1,c.length);if(c==encodeURI(a)){f=true}}}catch(g){}return f}function ScrollToWidget(f,d,c){var b=document.getElementById(f);var e=getAbsoluteLeft(b);var a=getAbsoluteTop(b);if(c){document.body.scrollTop=a}if(d){document.body.scrollLeft=e}}var widgetIdToShowFunction=new Object();var widgetIdToHideFunction=new Object();function SetPanelVisibility(a,c,g,d){var f=document.getElementById(a);if(c=="toggle"){if(f.style.visibility=="hidden"){c=""}else{c="hidden"}}if((f.style.visibility=="hidden"&&c=="hidden")||(f.style.visibility==""&&c=="")){return}if(g=="none"){f.style.display="";f.style.visibility=c}else{if(g=="fade"){if(c=="hidden"){if(f.style.visibility!="hidden"){$("#"+a).fadeOut(d,function(){$("#"+a).css("visibility","hidden")})}}else{if(f.style.visibility=="hidden"){f.style.display="none";f.style.visibility="";$("#"+a).fadeIn(d,function(){})}}}}if(c=="hidden"){var e=widgetIdToHideFunction[a];if(e){e()}}else{var b=widgetIdToShowFunction[a];if(b){b()}}}var widgetIdToPanelStateChangeFunction=new Object();function SetPanelState(m,j,f,s,e,k,l,q){if($("#"+j).css("visibility")!="hidden"&&$("#"+m).css("visibility")!="hidden"){return}var p=$("#"+m).width();var o=$("#"+m).height();var t=GetPanelState(m);if(t==""){$("#"+m+"> div[visibility!=hidden]").css("visibility","hidden");$("#"+m+"> div[visibility!=hidden]").css("display","")}else{var c=$("#"+t);if(f=="none"){c.css("visibility","hidden");c.css("display","");BringPanelStateToFront(m,j)}else{if(f=="fade"){var a=Number(c.css("top").replace("px",""));var d=Number(c.css("left").replace("px",""));var n=c.width();var h=c.height();c.css("width",p-d+"px");c.css("height",o-a+"px");c.fadeOut(e,function(){c.css("visibility","hidden");BringPanelStateToFront(m,j);c.css("width",n+"px");c.css("height",h+"px")})}else{var a=c.css("top");var d=c.css("left");var r=function(){c.css("visibility","hidden");c.css("top",a);c.css("left",d);BringPanelStateToFront(m,j)};if(s=="right"){MoveWidgetBy(t,p,0,f,e,r)}else{if(s=="left"){MoveWidgetBy(t,-p,0,f,e,r)}else{if(s=="up"){MoveWidgetBy(t,0,-o,f,e,r)}else{if(s=="down"){MoveWidgetBy(t,0,o,f,e,r)}}}}}}}$("#"+m).css("display","");$("#"+m).css("visibility","");var b=$("#"+j);if(k=="none"){b.css("visibility","");b.css("display","")}else{if(k=="fade"){b.css("display","none");b.css("visibility","");b.fadeIn(q,function(){})}else{var a=Number(b.css("top").replace("px",""));var d=Number(b.css("left").replace("px",""));if(l=="right"){b.css("left",d-p+"px")}else{if(l=="left"){b.css("left",d+p+"px")}else{if(l=="up"){b.css("top",a+o+"px")}else{if(l=="down"){b.css("top",a-o+"px")}}}}b.css("display","");b.css("visibility","");if(l=="right"){MoveWidgetBy(j,p,0,k,q)}else{if(l=="left"){MoveWidgetBy(j,-p,0,k,q)}else{if(l=="up"){MoveWidgetBy(j,0,-o,k,q)}else{if(l=="down"){MoveWidgetBy(j,0,o,k,q)}}}}}}var g=widgetIdToPanelStateChangeFunction[m];if(g){g()}}function BringPanelStateToFront(a,b){$("#"+b).appendTo($("#"+a))}var widgetIdToMoveFunction=new Object();var widgetMoveInfo=new Object();function MoveWidgetTo(h,b,g,f,e){var d=document.getElementById(h);var c=b-parseInt(d.style.left);var a=g-parseInt(d.style.top);MoveWidgetBy(h,c,a,f,e)}function MoveWidgetBy(a,h,g,f,b,c){LogMovedWidgetForDrag(a);if(f=="none"){var e=document.getElementById(a);e.style.left=parseInt(e.style.left)+h;e.style.top=parseInt(e.style.top)+g}else{$("#"+a).animate({left:"+="+h,top:"+="+g},b,f,c)}var d=new Object();d.x=h;d.y=g;d.easing=f;d.duration=b;widgetMoveInfo[a]=d;var j=widgetIdToMoveFunction[a];if(j){j()}}function MoveWidgetWithThis(c,b){var a=widgetMoveInfo[b];if(a){MoveWidgetBy(c,a.x,a.y,a.easing,a.duration)}}function MoveWidgetToLocationBeforeDrag(d,c,a){if(widgetDragInfo.movedWidgets[d]){var b=widgetDragInfo.movedWidgets[d];MoveWidgetTo(d,b.x,b.y,c,a)}}function LogMovedWidgetForDrag(e){if(widgetDragInfo.hasStarted){var b=document.getElementById(e);var a=parseInt(b.style.left);var d=parseInt(b.style.top);var c=widgetDragInfo.movedWidgets;if(!c[e]){c[e]=new Location(a,d)}}}var widgetIdToStartDragFunction=new Object();var widgetIdToDragFunction=new Object();var widgetIdToDragDropFunction=new Object();var widgetDragInfo=new Object();function StartDragWidget(b,d){var a,c;if(bIE){a=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;c=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}else{a=b.pageX;c=b.pageY}widgetDragInfo.hasStarted=false;widgetDragInfo.widgetId=d;widgetDragInfo.cursorStartX=a;widgetDragInfo.cursorStartY=c;widgetDragInfo.lastX=a;widgetDragInfo.lastY=c;widgetDragInfo.currentX=a;widgetDragInfo.currentY=c;widgetDragInfo.movedWidgets=new Object();if(bIE){document.attachEvent("onmousemove",DragWidget);document.attachEvent("onmouseup",StopDragWidget)}else{document.addEventListener("mousemove",DragWidget,true);document.addEventListener("mouseup",StopDragWidget,true);b.preventDefault()}SuppressBubble(b)}function DragWidget(c){var a,f;if(bIE){a=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;f=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}else{a=c.pageX;f=c.pageY}widgetDragInfo.xDelta=a-widgetDragInfo.currentX;widgetDragInfo.yDelta=f-widgetDragInfo.currentY;widgetDragInfo.lastX=widgetDragInfo.currentX;widgetDragInfo.lastY=widgetDragInfo.currentY;widgetDragInfo.currentX=a;widgetDragInfo.currentY=f;SuppressBubble(c);if(!widgetDragInfo.hasStarted){widgetDragInfo.hasStarted=true;var b=widgetIdToStartDragFunction[widgetDragInfo.widgetId];if(b){b()}widgetDragInfo.oldBodyCursor=document.body.style.cursor;document.body.style.cursor="move";var d=document.getElementById(widgetDragInfo.widgetId);widgetDragInfo.oldCursor=d.style.cursor;d.style.cursor="move"}var e=widgetIdToDragFunction[widgetDragInfo.widgetId];if(e){e()}}function StopDragWidget(b){if(bIE){document.detachEvent("onmousemove",DragWidget);document.detachEvent("onmouseup",StopDragWidget)}else{document.removeEventListener("mousemove",DragWidget,true);document.removeEventListener("mouseup",StopDragWidget,true)}if(widgetDragInfo.hasStarted){var a=widgetIdToDragDropFunction[widgetDragInfo.widgetId];if(a){a()}document.body.style.cursor=widgetDragInfo.oldBodyCursor;var c=document.getElementById(widgetDragInfo.widgetId);c.style.cursor=widgetDragInfo.oldCursor}widgetDragInfo.hasStarted=false;widgetDragInfo.movedWidgets=new Object()}function GetDragCursorRectangles(){var a=new Object();a.lastRect=new Rectangle(widgetDragInfo.lastX,widgetDragInfo.lastY,1,1);a.currentRect=new Rectangle(widgetDragInfo.currentX,widgetDragInfo.currentY,1,1);return a}function GetWidgetRectangles(c){var b=document.getElementById(c);var a=new Object();a.lastRect=new Rectangle(getAbsoluteLeft(b),getAbsoluteTop(b),Number($("#"+c).css("width").replace("px","")),Number($("#"+c).css("height").replace("px","")));a.currentRect=a.lastRect;return a}function IsEntering(b,a){return !b.lastRect.IntersectsWith(a.currentRect)&&b.currentRect.IntersectsWith(a.currentRect)}function IsLeaving(b,a){return b.lastRect.IntersectsWith(a.currentRect)&&!b.currentRect.IntersectsWith(a.currentRect)}function IsOver(b,a){return b.currentRect.IntersectsWith(a.currentRect)}function IsNotOver(b,a){return !IsOver(b,a)}function Rectangle(b,e,d,a){this.x=b;this.y=e;this.width=d;this.height=a;this.right=b+d;this.bottom=e+a;this.IntersectsWith=c;function c(f){return this.x<f.right&&this.right>f.x&&this.y<f.bottom&&this.bottom>f.y}}function Location(a,b){this.x=a;this.y=b}function ValueContains(b,a){return b.indexOf(a)>-1}function ValueNotContains(b,a){return !ValueContains(b,a)}function GetDayString(a){var b=new Array(7);b[0]="Sunday";b[1]="Monday";b[2]="Tuesday";b[3]="Wednesday";b[4]="Thursday";b[5]="Friday";b[6]="Saturday";return b[a]}function GetMonthString(a){var b=new Array(12);b[0]="January";b[1]="February";b[2]="March";b[3]="April";b[4]="May";b[5]="June";b[6]="July";b[7]="August";b[8]="September";b[9]="October";b[10]="November";b[11]="December";return b[a]}function SetCheckState(c,b){var a=Boolean(b);if(b=="false"){a=false}document.getElementById(c).checked=a}function SetSelectedOption(b,a){document.getElementById(b).value=a}function SetGlobalVariableValue(id,value){if(value.length>200){value=value.substring(0,200)}eval(id+" = value");try{eval("if (top.opener) { top.opener."+id+" = value }")}catch(e){}}function SetWidgetFormText(b,a){var a=PopulateVariables(a.toString());document.getElementById(b).value=a}function SetFocusedWidgetText(a){if(lastFocusedControl){var a=PopulateVariables(a.toString());lastFocusedControl.focus();lastFocusedControl.value=a}}function SetWidgetRichText(h,d){var d=PopulateVariables(d);var e=document.getElementById(h+"_rtf");var g=e.offsetHeight;e.innerHTML=d;var b=e.offsetHeight;var a=Number($("#"+h).css("top").replace("px",""));var f=gv_vAlignTable[h];if(f=="center"){var c=a-(b-g)/2;$("#"+h).css("top",c+"px")}else{if(f=="bottom"){var c=a-b+g;$("#"+h).css("top",c+"px")}}if(gv_OriginalTextCache[h]){CacheOriginalText(h)}}function GetCheckState(a){return document.getElementById(a).checked}function GetSelectedOption(a){return document.getElementById(a).value}function GetNum(a){if(!a){return""}result=Number(a);return isNaN(result)?a:result}function GetGlobalVariableValue(id){return eval(id)}function GetGlobalVariableLength(a){return GetGlobalVariableValue(a).length}function GetWidgetFormText(a){return document.getElementById(a).value}function GetFocusedWidgetText(a){if(lastFocusedControl){return lastFocusedControl.value}else{return""}}function GetWidgetValueLength(a){return document.getElementById(a).value.length}function GetWidgetVisibility(a){if(document.getElementById(a).style.visibility=="hidden"){return false}else{return true}}function GetPanelState(d){var c=document.getElementById(d);if(c.style.visibility=="hidden"){return""}var b=c.childNodes;for(var a=0;a<b.length;a++){if(b[a].style){if(b[a].style.visibility!="hidden"){return b[a].id}}}return""}function IsValueAlpha(b){var a=new RegExp("^[a-z\\s]+$","gi");return a.test(b)}function IsValueNumeric(b){var a=new RegExp("^[0-9,\\.\\s]+$","gi");return a.test(b)}function IsValueAlphaNumeric(b){var a=new RegExp("^[0-9a-z\\s]+$","gi");return a.test(b)}function IsValueOneOf(c,a){for(i=0;i<a.length;i++){var b=a[i];if(c==b){return true}}return false}function IsValueNotAlpha(a){return !IsValueAlpha(a)}function IsValueNotNumeric(a){return !IsValueNumeric(a)}function IsValueNotAlphaNumeric(a){return !IsValueAlphaNumeric(a)}function IsValueNotOneOf(b,a){return !IsValueOneOf(b,a)}function SetWidgetOriginal(d,c){var b="u"+(parseInt(d.substring(1))+1);var a="";ApplyImageAndTextJson(d,b,a,c,true)}function SetWidgetHover(d,c){if(IsWidgetSelected(d)){return}var b="u"+(parseInt(d.substring(1))+1);var a="";if(window["Json"+d+"_hover"]){a=window["Json"+d+"_hover"]}ApplyImageAndTextJson(d,b,a,c,false)}function SetWidgetNotHover(b,a){if(IsWidgetSelected(b)){return}SetWidgetOriginal(b,a)}function SetWidgetMouseDown(d,c){if(IsWidgetSelected(d)){return}var b="u"+(parseInt(d.substring(1))+1);var a="";if(window["Json"+d+"_down"]){a=window["Json"+d+"_down"]}ApplyImageAndTextJson(d,b,a,c,false)}function SetWidgetNotMouseDown(b,a){if(IsWidgetSelected(b)){return}if(window["Json"+b+"_hover"]){SetWidgetHover(b,a)}else{SetWidgetOriginal(b,a)}}var gv_SelectedWidgets=new Object();function SetWidgetSelected(d){var c=$("#"+d).attr("selectiongroup");if(c){$("[selectiongroup='"+c+"'][visibility!='hidden']").each(function(e,f){SetWidgetNotSelected($(f).attr("id"))})}var b="u"+(parseInt(d.substring(1))+1);var a="";if(window["Json"+d+"_selected"]){a=window["Json"+d+"_selected"]}ApplyImageAndTextJson(d,b,a,false,false);gv_SelectedWidgets[d]="true"}function SetWidgetNotSelected(a){SetWidgetOriginal(a,false);gv_SelectedWidgets[a]="false"}function IsWidgetSelected(a){if(gv_SelectedWidgets[a]&&gv_SelectedWidgets[a]=="true"){return true}return false}function DisableImageWidget(c){document.getElementById(c).style.visibility="hidden";var b="u"+(parseInt(c.substring(1))+1);var a="";if(window["Json"+c+"_disabled"]){a=window["Json"+c+"_disabled"]}ApplyImageAndTextJson(c,b,a,false,false)}function EnableImageWidget(a){document.getElementById(a).style.visibility="";SetWidgetOriginal(a,false)}function ApplyImageAndTextJson(f,e,b,c,a){var d=document.getElementById(f);if(d&&d.style.visibility=="hidden"&&a){return}ResetImagesAndTextJson(f,e);if(b!=""){ApplyImageStyle(f,b);ApplyTextStyle(e,b)}if(c){BringToFront(f+"_container");BringToFront(f);BringToFront(f+"ann")}}function ApplyImageStyle(c,a){CacheOriginalImgSrc(c);if(a.imgclass){$("#"+c+"_img").removeClass().empty();$("#"+c+"_img").addClass(a.imgclass)}else{if(a.imgsrc){$("#"+c+"_img").removeClass().empty();var b=a.imgsrc;$("#"+c+"_img").html("<IMG src='"+b+"' class='raw_image'>")}}}function CacheOriginalImgSrc(b){if(!gv_OriginalImgSrc[b+"_img"]){var a=$("#"+b+"_img > img").attr("src");if(a){gv_OriginalImgSrc[b+"_img"]=a}else{gv_OriginalImgSrc[b+"_img"]="none"}}}function ResetImagesAndTextJson(e,c){CacheOriginalImgSrc(e);$("#"+e+"_img").removeClass().empty();if(gv_OriginalImgSrc[e+"_img"]&&gv_OriginalImgSrc[e+"_img"]!="none"){$("#"+e+"_img").html("<IMG src='"+gv_OriginalImgSrc[e+"_img"]+"' class='raw_image'>")}else{$("#"+e+"_img").addClass(e+"_original")}var b=gv_OriginalTextCache[c];if(b){var d=document.getElementById(c+"_rtf");var a=document.getElementById(c);d.innerHTML=b.innerHTML;a.style.top=b.top}}function ApplyTextStyle(d,m){if(!gv_OriginalTextCache[d]){CacheOriginalText(d)}var h=document.getElementById(d+"_rtf");if(!h){return}var k=h.offsetHeight;for(var b in m){if(b!="imgclass"){l(h,b,m[b])}}var a=h.offsetHeight;var c=document.getElementById(d);var f=Number($("#"+d).css("top").replace("px",""));var g=gv_vAlignTable[d];if(g=="center"){var j=f-(a-k)/2;$("#"+d).css("top",j+"px")}else{if(g=="bottom"){var j=f-a+k;$("#"+d).css("top",j+"px")}}function e(q,p,n){var r=q.nodeName.toLowerCase();if(r=="div"||r=="span"||r=="p"){q.style[p]=n}for(var o=0;o<q.childNodes.length;o++){e(q.childNodes[o],p,n)}}function l(q,r,p){var o=q.innerHTML;if(r=="fontWeight"){q.innerHTML=o.replace(/< *b *\/?>/gi,"")}else{if(r=="fontStyle"){q.innerHTML=o.replace(/< *i *\/?>/gi,"")}else{if(r=="textDecoration"){q.innerHTML=o.replace(/< *u *\/?>/gi,"")}}}for(var n=0;n<q.childNodes.length;n++){e(q.childNodes[n],r,p)}}}function CacheOriginalText(c){var b=document.getElementById(c+"_rtf");if(!b){return}var a=new Object();a.innerHTML=b.innerHTML;a.top=$("#"+c).css("top");gv_OriginalTextCache[c]=a};